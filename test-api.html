<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>PDJSONEditor API Test Dashboard</title>
		<style>
			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}

			body {
				font-family:
					-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
				background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
				min-height: 100vh;
				padding: 20px;
			}

			.container {
				max-width: 1200px;
				margin: 0 auto;
			}

			h1 {
				color: white;
				text-align: center;
				margin-bottom: 30px;
				font-size: 2.5em;
				text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
			}

			.test-grid {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
				gap: 20px;
				margin-bottom: 30px;
			}

			.test-card {
				background: white;
				border-radius: 12px;
				padding: 20px;
				box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
				transition:
					transform 0.3s ease,
					box-shadow 0.3s ease;
			}

			.test-card:hover {
				transform: translateY(-5px);
				box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
			}

			.test-card h2 {
				color: #333;
				margin-bottom: 15px;
				font-size: 1.3em;
				border-bottom: 2px solid #667eea;
				padding-bottom: 10px;
			}

			.test-button {
				width: 100%;
				padding: 12px;
				margin: 8px 0;
				background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
				color: white;
				border: none;
				border-radius: 8px;
				font-size: 14px;
				font-weight: 600;
				cursor: pointer;
				transition: all 0.3s ease;
				position: relative;
				overflow: hidden;
			}

			.test-button:hover {
				transform: scale(1.05);
				box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
			}

			.test-button:active {
				transform: scale(0.98);
			}

			.test-button.success {
				background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
			}

			.test-button.error {
				background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%);
			}

			.method-badge {
				display: inline-block;
				padding: 4px 8px;
				border-radius: 4px;
				font-size: 11px;
				font-weight: bold;
				margin-right: 8px;
				color: white;
			}

			.method-get {
				background: #10b981;
			}
			.method-post {
				background: #3b82f6;
			}
			.method-put {
				background: #f59e0b;
			}
			.method-patch {
				background: #8b5cf6;
			}
			.method-delete {
				background: #ef4444;
			}

			.result-panel {
				background: white;
				border-radius: 12px;
				padding: 20px;
				box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
				margin-top: 20px;
			}

			.result-panel h2 {
				color: #333;
				margin-bottom: 15px;
				font-size: 1.5em;
			}

			.result-content {
				background: #f3f4f6;
				border-radius: 8px;
				padding: 15px;
				font-family: 'Courier New', monospace;
				font-size: 14px;
				max-height: 400px;
				overflow-y: auto;
				white-space: pre-wrap;
				word-break: break-word;
			}

			.status-indicator {
				display: inline-block;
				width: 12px;
				height: 12px;
				border-radius: 50%;
				margin-right: 8px;
				animation: pulse 2s infinite;
			}

			.status-success {
				background: #10b981;
			}
			.status-error {
				background: #ef4444;
			}
			.status-pending {
				background: #f59e0b;
			}

			@keyframes pulse {
				0%,
				100% {
					opacity: 1;
				}
				50% {
					opacity: 0.5;
				}
			}

			.server-status {
				text-align: center;
				color: white;
				margin-bottom: 20px;
				font-size: 1.1em;
			}

			.test-info {
				color: #666;
				font-size: 12px;
				margin-top: 5px;
			}

			.loader {
				border: 3px solid #f3f3f3;
				border-top: 3px solid #667eea;
				border-radius: 50%;
				width: 20px;
				height: 20px;
				animation: spin 1s linear infinite;
				display: inline-block;
				margin-left: 10px;
			}

			@keyframes spin {
				0% {
					transform: rotate(0deg);
				}
				100% {
					transform: rotate(360deg);
				}
			}
		</style>
	</head>
	<body>
		<div class="container">
			<h1>ðŸ§ª PDJSONEditor API Test Dashboard</h1>

			<div class="server-status" id="serverStatus">
				<span class="status-indicator status-pending"></span>
				Checking server status...
			</div>

			<div class="test-grid">
				<!-- GET Tests -->
				<div class="test-card">
					<h2>GET Requests</h2>
					<button class="test-button" onclick="runTest(event, 'GET', '/api/users')">
						<span class="method-badge method-get">GET</span>
						Get All Users
					</button>
					<button class="test-button" onclick="runTest(event, 'GET', '/api/products')">
						<span class="method-badge method-get">GET</span>
						Get Products
					</button>
					<button class="test-button" onclick="runTest(event, 'GET', '/api/complex')">
						<span class="method-badge method-get">GET</span>
						Get Complex Data
					</button>
					<button class="test-button" onclick="runTest(event, 'GET', '/api/array')">
						<span class="method-badge method-get">GET</span>
						Get Array Data
					</button>
					<button class="test-button" onclick="runTest(event, 'GET', '/api/search?q=test&limit=5')">
						<span class="method-badge method-get">GET</span>
						Search with Query
					</button>
					<button class="test-button" onclick="runTest(event, 'GET', '/api/large?size=50')">
						<span class="method-badge method-get">GET</span>
						Large Dataset (50 items)
					</button>
				</div>

				<!-- POST Tests -->
				<div class="test-card">
					<h2>POST Requests</h2>
					<button
						class="test-button"
						onclick="runTest(event, 'POST', '/api/echo', {test: 'data', timestamp: Date.now()})"
					>
						<span class="method-badge method-post">POST</span>
						Echo Test
					</button>
					<button
						class="test-button"
						onclick="runTest(event, 'POST', '/api/users', {name: 'Test User', email: 'test@test.com', age: 25})"
					>
						<span class="method-badge method-post">POST</span>
						Create User
					</button>
					<button class="test-button" onclick="runTest(event, 'POST', '/api/reset')">
						<span class="method-badge method-post">POST</span>
						Reset Data
					</button>
				</div>

				<!-- PUT/PATCH Tests -->
				<div class="test-card">
					<h2>PUT/PATCH Requests</h2>
					<button
						class="test-button"
						onclick="runTest(event, 'PUT', '/api/users/1', {name: 'Updated User', email: 'updated@test.com', age: 30})"
					>
						<span class="method-badge method-put">PUT</span>
						Update User 1
					</button>
					<button class="test-button" onclick="runTest(event, 'PATCH', '/api/users/1', {age: 35})">
						<span class="method-badge method-patch">PATCH</span>
						Patch User 1
					</button>
					<button
						class="test-button"
						onclick="runTest(event, 'PATCH', '/api/users/2', {active: true})"
					>
						<span class="method-badge method-patch">PATCH</span>
						Patch User 2
					</button>
				</div>

				<!-- DELETE Tests -->
				<div class="test-card">
					<h2>DELETE Requests</h2>
					<button class="test-button" onclick="runTest(event, 'DELETE', '/api/users/2')">
						<span class="method-badge method-delete">DELETE</span>
						Delete User 2
					</button>
					<button class="test-button" onclick="runTest(event, 'DELETE', '/api/users/1')">
						<span class="method-badge method-delete">DELETE</span>
						Delete User 1
					</button>
				</div>

				<!-- Error Tests -->
				<div class="test-card">
					<h2>Error Handling</h2>
					<button class="test-button" onclick="runTest(event, 'GET', '/api/error/400')">
						<span class="method-badge method-get">GET</span>
						400 Bad Request
					</button>
					<button class="test-button" onclick="runTest(event, 'GET', '/api/error/500')">
						<span class="method-badge method-get">GET</span>
						500 Server Error
					</button>
					<button class="test-button" onclick="runTest(event, 'GET', '/api/users/999')">
						<span class="method-badge method-get">GET</span>
						404 Not Found
					</button>
					<button class="test-button" onclick="runTest(event, 'GET', '/api/slow?delay=2000')">
						<span class="method-badge method-get">GET</span>
						Slow Response (2s)
					</button>
				</div>

				<!-- Header Tests -->
				<div class="test-card">
					<h2>Headers & Custom</h2>
					<button class="test-button" onclick="runTestWithHeaders(event, 'GET', '/api/headers')">
						<span class="method-badge method-get">GET</span>
						Test Headers
					</button>
					<button
						class="test-button"
						onclick="runTestWithHeaders(event, 'POST', '/api/headers', {custom: 'body'})"
					>
						<span class="method-badge method-post">POST</span>
						Headers + Body
					</button>
				</div>
			</div>

			<div class="result-panel">
				<h2>Test Results</h2>
				<div class="result-content" id="resultContent">
					Click any test button to see the results here...
				</div>
			</div>
		</div>

		<script>
			const API_BASE = 'http://localhost:3001';

			// Check server status on load
			window.onload = async () => {
				await checkServerStatus();
			};

			async function checkServerStatus() {
				const statusEl = document.getElementById('serverStatus');
				try {
					const response = await fetch(API_BASE + '/');
					if (response.ok) {
						statusEl.innerHTML =
							'<span class="status-indicator status-success"></span>Test server is running at ' +
							API_BASE;
					} else {
						statusEl.innerHTML =
							'<span class="status-indicator status-error"></span>Server is not responding properly';
					}
				} catch (error) {
					statusEl.innerHTML =
						'<span class="status-indicator status-error"></span>Test server is not running. Run: npm run test:server';
				}
			}

			async function runTest(event, method, endpoint, body = null) {
				const resultEl = document.getElementById('resultContent');
				const url = API_BASE + endpoint;

				// Show loading
				resultEl.innerHTML = `<span class="loader"></span> Running ${method} ${endpoint}...`;

				const options = {
					method: method,
					headers: {
						'Content-Type': 'application/json'
					}
				};

				if (body && (method === 'POST' || method === 'PUT' || method === 'PATCH')) {
					options.body = JSON.stringify(body);
				}

				try {
					const startTime = Date.now();
					const response = await fetch(url, options);
					const elapsed = Date.now() - startTime;

					const data = await response.json();

					// Format result
					const result = {
						request: {
							method: method,
							url: url,
							body: body
						},
						response: {
							status: response.status,
							statusText: response.statusText,
							elapsed: elapsed + 'ms',
							data: data
						}
					};

					resultEl.innerHTML = JSON.stringify(result, null, 2);

					// Update button status
					event.target.classList.remove('error');
					event.target.classList.add('success');
					setTimeout(() => {
						event.target.classList.remove('success');
					}, 2000);
				} catch (error) {
					resultEl.innerHTML = JSON.stringify(
						{
							error: error.message,
							request: {
								method: method,
								url: url,
								body: body
							}
						},
						null,
						2
					);

					// Update button status
					event.target.classList.remove('success');
					event.target.classList.add('error');
					setTimeout(() => {
						event.target.classList.remove('error');
					}, 2000);
				}
			}

			async function runTestWithHeaders(event, method, endpoint, body = null) {
				const resultEl = document.getElementById('resultContent');
				const url = API_BASE + endpoint;

				// Show loading
				resultEl.innerHTML = `<span class="loader"></span> Running ${method} ${endpoint} with custom headers...`;

				const options = {
					method: method,
					headers: {
						'Content-Type': 'application/json',
						Authorization: 'Bearer test-token-123',
						'X-Custom-Header': 'CustomValue',
						'X-Request-ID': 'req-' + Date.now()
					}
				};

				if (body && (method === 'POST' || method === 'PUT' || method === 'PATCH')) {
					options.body = JSON.stringify(body);
				}

				try {
					const startTime = Date.now();
					const response = await fetch(url, options);
					const elapsed = Date.now() - startTime;

					const data = await response.json();

					// Format result
					const result = {
						request: {
							method: method,
							url: url,
							headers: options.headers,
							body: body
						},
						response: {
							status: response.status,
							statusText: response.statusText,
							elapsed: elapsed + 'ms',
							data: data
						}
					};

					resultEl.innerHTML = JSON.stringify(result, null, 2);

					// Update button status
					event.target.classList.remove('error');
					event.target.classList.add('success');
					setTimeout(() => {
						event.target.classList.remove('success');
					}, 2000);
				} catch (error) {
					resultEl.innerHTML = JSON.stringify(
						{
							error: error.message,
							request: {
								method: method,
								url: url,
								headers: options.headers,
								body: body
							}
						},
						null,
						2
					);

					// Update button status
					event.target.classList.remove('success');
					event.target.classList.add('error');
					setTimeout(() => {
						event.target.classList.remove('error');
					}, 2000);
				}
			}
		</script>
	</body>
</html>
